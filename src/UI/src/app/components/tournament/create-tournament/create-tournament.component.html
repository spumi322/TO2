<div class="create-tournament-container">
  <div class="create-tournament-card">
    <div class="tournament-header">
      <h2>Create Tournament</h2>
    </div>

    <form [formGroup]="form" (ngSubmit)="submit()" class="tournament-form">
      <!-- Tournament Name -->
      <div class="field">
        <label for="name">Tournament Name</label>
        <input id="name"
               type="text"
               formControlName="name"
               [class.invalid]="form.get('name')?.invalid && form.get('name')?.touched"
               [pTooltip]="getErrorMessage('name')"
               tooltipPosition="right"
               [showDelay]="0"
               tooltipStyleClass="error-tooltip" />
      </div>

      <!-- Description -->
      <div class="field">
        <label for="description">Description</label>
        <textarea id="description"
                  formControlName="description"
                  rows="1"
                  [class.invalid]="form.get('description')?.invalid && form.get('description')?.touched"
                  [pTooltip]="getErrorMessage('description')"
                  tooltipPosition="right"
                  [showDelay]="0"
                  tooltipStyleClass="error-tooltip"></textarea>
      </div>

      <!-- Tournament Format -->
      <div class="field">
        <label>Tournament Format</label>
        <div class="format-options">
          <div class="format-option"
               [class.selected]="form.get('format')?.value === Format.BracketOnly"
               (click)="selectFormat(Format.BracketOnly)">
            <input type="radio"
                   [value]="Format.BracketOnly"
                   formControlName="format"
                   id="format-bracket" />
            <div class="format-details">
              <span class="format-name">Bracket Only</span>
              <span class="format-desc">Single-elimination knockout</span>
            </div>
          </div>

          <div class="format-option"
               [class.selected]="form.get('format')?.value === Format.GroupsAndBracket"
               (click)="selectFormat(Format.GroupsAndBracket)">
            <input type="radio"
                   [value]="Format.GroupsAndBracket"
                   formControlName="format"
                   id="format-groups-bracket" />
            <div class="format-details">
              <span class="format-name">Groups + Bracket</span>
              <span class="format-desc">Groups then playoffs Bracket</span>
            </div>
          </div>

          <div class="format-option"
               [class.selected]="form.get('format')?.value === Format.GroupsOnly"
               (click)="selectFormat(Format.GroupsOnly)">
            <input type="radio"
                   [value]="Format.GroupsOnly"
                   formControlName="format"
                   id="format-groups" />
            <div class="format-details">
              <span class="format-name">Groups Only</span>
              <span class="format-desc">Round-robin Groups</span>
            </div>
          </div>
        </div>
        <small class="error-message" *ngIf="form.get('format')?.invalid && form.get('format')?.touched">
          Please select a tournament format
        </small>
      </div>

      <!-- Bracket Only Config -->
      <div *ngIf="form.get('format')?.value === Format.BracketOnly">
        <div class="field">
          <label for="maxTeamsBracket">Tournament Size</label>
          <select id="maxTeamsBracket"
                  formControlName="maxTeams"
                  [class.invalid]="form.get('maxTeams')?.invalid && form.get('maxTeams')?.touched"
                  [pTooltip]="getErrorMessage('maxTeams')"
                  tooltipPosition="right"
                  [showDelay]="0"
                  tooltipStyleClass="error-tooltip">
            <option value="" disabled selected>Select team count</option>
            <option *ngFor="let option of bracketSizeOptions" [value]="option.value">
              {{ option.label }}
            </option>
          </select>
        </div>
      </div>
      <!-- Groups Only Config -->
      <div *ngIf="form.get('format')?.value === Format.GroupsOnly">
        <div class="field-row">
          <div class="field">
            <label for="maxTeamsGB">Total Teams</label>
            <input id="maxTeamsGB"
                   type="number"
                   formControlName="maxTeams"
                   placeholder="2-32"
                   min="2"
                   max="32"
                   [class.invalid]="form.get('maxTeams')?.invalid && form.get('maxTeams')?.touched"
                   [pTooltip]="getErrorMessage('maxTeams')"
                   tooltipPosition="right"
                   [showDelay]="0"
                   tooltipStyleClass="error-tooltip" />
          </div>
          <div class="field">
            <label for="teamsPerGroup">Teams per Group</label>
            <input id="teamsPerGroup"
                   type="number"
                   formControlName="teamsPerGroup"
                   placeholder="2-16"
                   min="2"
                   max="16"
                   [class.invalid]="form.get('teamsPerGroup')?.invalid && form.get('teamsPerGroup')?.touched"
                   [pTooltip]="getErrorMessage('teamsPerGroup')"
                   tooltipPosition="right"
                   [showDelay]="0"
                   tooltipStyleClass="error-tooltip" />
        </div>
      </div>
      </div>


      <!-- Groups + Bracket Config -->
      <div *ngIf="form.get('format')?.value === Format.GroupsAndBracket">
        <div class="field-row">
          <div class="field">
            <label for="maxTeamsGB">Total Teams</label>
            <input id="maxTeamsGB"
                   type="number"
                   formControlName="maxTeams"
                   placeholder="2-32"
                   min="2"
                   max="32"
                   [class.invalid]="form.get('maxTeams')?.invalid && form.get('maxTeams')?.touched"
                   [pTooltip]="getErrorMessage('maxTeams')"
                   tooltipPosition="right"
                   [showDelay]="0"
                   tooltipStyleClass="error-tooltip" />
          </div>
          <div class="field">
            <label for="teamsPerGroup">Teams per Group</label>
            <input id="teamsPerGroup"
                   type="number"
                   formControlName="teamsPerGroup"
                   placeholder="2-16"
                   min="2"
                   max="16"
                   [class.invalid]="form.get('teamsPerGroup')?.invalid && form.get('teamsPerGroup')?.touched"
                   [pTooltip]="getErrorMessage('teamsPerGroup')"
                   tooltipPosition="right"
                   [showDelay]="0"
                   tooltipStyleClass="error-tooltip" />
          </div>
          <div class="field">
            <label for="teamsPerBracket">Bracket Size</label>
            <input id="teamsPerBracket"
                   type="number"
                   formControlName="teamsPerBracket"
                   placeholder="2-32"
                   min="2"
                   max="32"
                   [class.invalid]="form.get('teamsPerBracket')?.invalid && form.get('teamsPerBracket')?.touched"
                   [pTooltip]="getErrorMessage('teamsPerBracket')"
                   tooltipPosition="right"
                   [showDelay]="0"
                   tooltipStyleClass="error-tooltip" />
          </div>
        </div>
      </div>

      <!-- Submit Button -->
      <button type="submit"
              class="submit-button"
              [disabled]="form.invalid || isSubmitting">
        <span *ngIf="!isSubmitting">Create Tournament</span>
        <span *ngIf="isSubmitting">Creating...</span>
      </button>

      <!-- Cancel Button -->
      <button type="button"
              class="cancel-button"
              routerLink="/tournaments">
        Cancel
      </button>
    </form>
  </div>
</div>

<p-toast position="top-right"></p-toast>
