<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36" version="28.2.7">
  <diagram name="Tournament System - UML Class Diagram" id="tKy9KOiioyH30LHpttdy">
    <mxGraphModel dx="2593" dy="1427" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="X7BS_atAVVZSwV2Onjna-1" value="Tournament Management System - Service Layer Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="800" y="36" width="600" height="40" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-2" value="«layer»&#xa;Service Interfaces" style="shape=folder;tabWidth=100;tabHeight=30;tabPosition=left;html=1;boundedLbl=1;labelInHeader=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="96" width="3400" height="300" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-3" value="&lt;&lt;interface&gt;&gt;&#xa;ITournamentService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="80" y="146" width="380" height="220" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-4" value="+ CreateTournamentAsync(request): CreateTournamentResponseDTO&#xa;+ GetTournamentAsync(id): GetTournamentResponseDTO&#xa;+ GetAllTournamentsAsync(): List&lt;GetAllTournamentsResponseDTO&gt;&#xa;+ UpdateTournamentAsync(id, request): UpdateTournamentResponseDTO&#xa;+ StartTournament(tournamentId): StartTournamentDTO&#xa;+ GetTeamsByTournamentAsync(tournamentId): List&lt;GetTeamResponseDTO&gt;&#xa;+ RemoveTeamFromTournamentAsync(teamId, tournamentId): void&#xa;+ DeclareChampion(tournamentId, championTeamId): void&#xa;+ GetChampion(tournamentId): GetTeamResponseDTO?&#xa;+ GetFinalStandings(tournamentId): List&lt;FinalStandingDTO&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=10;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-3">
          <mxGeometry y="40" width="380" height="180" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-5" value="&lt;&lt;interface&gt;&gt;&#xa;ITeamService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="500" y="146" width="420" height="180" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-6" value="+ CreateTeamAsync(request): CreateTeamResponseDTO&#xa;+ GetAllTeamsAsync(): List&lt;GetAllTeamsResponseDTO&gt;&#xa;+ GetTeamAsync(teamId): GetTeamResponseDTO&#xa;+ GetTeamsWithStatsAsync(standingId): List&lt;GetTeamWithStatsResponseDTO&gt;&#xa;+ UpdateTeamAsync(id, request): UpdateTeamResponseDTO&#xa;+ DeleteTeamAsync(teamId): void&#xa;+ AddTeamToTournamentAsync(request): AddTeamToTournamentResponseDTO" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=10;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-5">
          <mxGeometry y="40" width="420" height="140" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-7" value="&lt;&lt;interface&gt;&gt;&#xa;IMatchService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="960" y="146" width="480" height="140" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-8" value="+ GetMatchAsync(id): Match&#xa;+ GetMatchesAsync(standingId): List&lt;Match&gt;&#xa;+ GenerateMatch(teamA, teamB, round, seed, standingId): long&#xa;+ SeedGroups(tournamentId): SeedGroupsResponseDTO&#xa;+ SeedBracket(tournamentId, advancedTeams): BracketSeedResponseDTO&#xa;+ CheckAndGenerateNextRound(tournamentId, standingId, currentRound): void" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=10;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-7">
          <mxGeometry y="40" width="480" height="100" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-9" value="&lt;&lt;interface&gt;&gt;&#xa;IGameService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1480" y="146" width="380" height="140" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-10" value="+ GenerateGames(matchId): void&#xa;+ GetGameAsync(gameId): Game&#xa;+ GetAllGamesByMatch(matchId): List&lt;Game&gt;&#xa;+ SetGameResult(gameId, request): MatchResultDTO?&#xa;+ DetermineMatchWinner(matchId): MatchResult?&#xa;+ UpdateStandingAfterMatch(match): void" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=10;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-9">
          <mxGeometry y="40" width="380" height="100" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-11" value="&lt;&lt;interface&gt;&gt;&#xa;IStandingService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1900" y="146" width="480" height="140" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-12" value="+ GenerateStanding(tournamentId, name, type, teamsPerStanding): void&#xa;+ GetStandingsAsync(tournamentId): List&lt;Standing&gt;&#xa;+ CheckAndMarkStandingAsFinishedAsync(tournamentId): bool&#xa;+ CheckAndMarkAllGroupsAreFinishedAsync(tournamentId): bool&#xa;+ PrepareTeamsForBracket(tournamentId): List&lt;BracketSeedDTO&gt;" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=10;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-11">
          <mxGeometry y="40" width="480" height="100" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-13" value="&lt;&lt;interface&gt;&gt;&#xa;ITournamentLifecycleService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=40;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="2420" y="146" width="540" height="100" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-14" value="+ OnMatchCompleted(matchId, winnerId, loserId, tournamentId): MatchResultDTO&#xa;+ SeedBracketIfReady(tournamentId): BracketSeedResponseDTO" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=10;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-13">
          <mxGeometry y="40" width="540" height="60" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-15" value="«layer»&#xa;Service Implementations" style="shape=folder;tabWidth=120;tabHeight=30;tabPosition=left;html=1;boundedLbl=1;labelInHeader=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=14;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="40" y="456" width="3400" height="700" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-16" value="TournamentService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="80" y="516" width="380" height="280" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-17" value="Dependencies:&#xa;- IGenericRepository&lt;Tournament&gt;&#xa;- ITeamService&#xa;- IStandingService&#xa;- ITO2DbContext&#xa;- IMapper&#xa;- ILogger" style="text;strokeColor=none;fillColor=#f0f0f0;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;fontStyle=2;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-16">
          <mxGeometry y="26" width="380" height="94" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-18" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-16">
          <mxGeometry y="120" width="380" height="8" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-19" value="Key Methods:&#xa;+ CreateTournamentAsync()&#xa;+ StartTournament() ⚠️ Only sets status&#xa;+ GetTeamsByTournamentAsync() [Called by MatchService]&#xa;+ DeclareChampion() [Called by MatchService]&#xa;+ GetChampion()&#xa;+ GetFinalStandings()&#xa;&#xa;⚠️ Issue: Uses both Repository AND DbContext" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-16">
          <mxGeometry y="128" width="380" height="152" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-20" value="TeamService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="500" y="516" width="420" height="240" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-21" value="Dependencies:&#xa;- IGenericRepository&lt;Team&gt;&#xa;- IGenericRepository&lt;Tournament&gt;&#xa;- IGenericRepository&lt;TournamentTeam&gt;&#xa;- ITO2DbContext&#xa;- IMapper&#xa;- ILogger" style="text;strokeColor=none;fillColor=#f0f0f0;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;fontStyle=2;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-20">
          <mxGeometry y="26" width="420" height="94" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-22" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-20">
          <mxGeometry y="120" width="420" height="8" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-23" value="Key Methods:&#xa;+ AddTeamToTournamentAsync() ✅ Excellent validation&#xa;  • Checks registration open&#xa;  • Validates capacity&#xa;  • Prevents duplicate names&#xa;+ GetTeamAsync() [Called by TournamentService]&#xa;+ GetTeamsWithStatsAsync()" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-20">
          <mxGeometry y="128" width="420" height="112" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-24" value="MatchService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="960" y="516" width="480" height="320" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-25" value="Dependencies:&#xa;- IStandingService&#xa;- ITournamentService&#xa;- IGenericRepository&lt;Match&gt;&#xa;- IGenericRepository&lt;Standing&gt;&#xa;- IGenericRepository&lt;Bracket&gt;&#xa;- ITO2DbContext&#xa;- IMapper&#xa;- ILogger" style="text;strokeColor=none;fillColor=#f0f0f0;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;fontStyle=2;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-24">
          <mxGeometry y="26" width="480" height="114" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-26" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-24">
          <mxGeometry y="140" width="480" height="8" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-27" value="Key Methods:&#xa;+ SeedGroups() ⚠️ CRITICAL: Uses 2 DbContexts!&#xa;  • _standingRepository.Save()&#xa;  • _dbContext.SaveChangesAsync()&#xa;  • Potential transaction boundary issue&#xa;+ SeedBracket() ⚠️ Does NOT save (caller must save)&#xa;+ GenerateMatch() ⚠️ Does NOT save (implicit behavior)&#xa;+ CheckAndGenerateNextRound()&#xa;  • Generates next bracket round OR declares champion&#xa;  • [Called by GameService]" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-24">
          <mxGeometry y="148" width="480" height="172" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-28" value="GameService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1480" y="516" width="380" height="300" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-29" value="Dependencies:&#xa;- IGenericRepository&lt;Game&gt;&#xa;- IGenericRepository&lt;Match&gt;&#xa;- IGenericRepository&lt;Standing&gt;&#xa;- IStandingService&#xa;- IMatchService&#xa;- ITournamentLifecycleService ✅&#xa;- ITO2DbContext&#xa;- ILogger" style="text;strokeColor=none;fillColor=#f0f0f0;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;fontStyle=2;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-28">
          <mxGeometry y="26" width="380" height="114" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-30" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-28">
          <mxGeometry y="140" width="380" height="8" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-31" value="Key Methods:&#xa;+ SetGameResult() ✅ Main entry point&#xa;  • Calls DetermineMatchWinner()&#xa;  • Calls OnMatchCompleted() [Lifecycle]&#xa;+ DetermineMatchWinner() [Internal]&#xa;  • Checks Bo1/Bo3/Bo5 thresholds&#xa;  • Calls UpdateStandingAfterMatch()&#xa;+ UpdateStandingAfterMatch() [Internal]&#xa;  • Groups: Updates wins/losses/points&#xa;  • Bracket: Sets status, calls CheckAndGenerateNextRound()" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-28">
          <mxGeometry y="148" width="380" height="152" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-32" value="StandingService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="1900" y="516" width="480" height="280" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-33" value="Dependencies:&#xa;- IGenericRepository&lt;Standing&gt;&#xa;- IGenericRepository&lt;Match&gt;&#xa;- IGenericRepository&lt;Tournament&gt;&#xa;- ITO2DbContext&#xa;- ILogger" style="text;strokeColor=none;fillColor=#f0f0f0;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;fontStyle=2;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-32">
          <mxGeometry y="26" width="480" height="84" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-34" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-32">
          <mxGeometry y="110" width="480" height="8" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-35" value="Key Methods:&#xa;+ GetStandingsAsync() ✅ HEAVILY USED (8 callers)&#xa;+ CheckAndMarkStandingAsFinishedAsync()&#xa;  • Loops all standings, checks if all matches done&#xa;  • [Called by LifecycleService]&#xa;+ CheckAndMarkAllGroupsAreFinishedAsync() ⚠️ MISLEADING NAME&#xa;  • Only checks, doesn&#39;t mark anything&#xa;  • Should rename to: AreAllGroupsFinishedAsync()&#xa;+ PrepareTeamsForBracket() ⚠️ Modifies entities, doesn&#39;t save" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-32">
          <mxGeometry y="118" width="480" height="162" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-36" value="TournamentLifecycleService" style="swimlane;fontStyle=1;align=center;verticalAlign=top;childLayout=stackLayout;horizontal=1;startSize=26;horizontalStack=0;resizeParent=1;resizeParentMax=0;resizeLast=0;collapsible=1;marginBottom=0;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="2420" y="516" width="540" height="280" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-37" value="Dependencies:&#xa;- IStandingService&#xa;- IMatchService&#xa;- IGenericRepository&lt;Standing&gt;&#xa;- ILogger" style="text;strokeColor=none;fillColor=#f0f0f0;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;fontStyle=2;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-36">
          <mxGeometry y="26" width="540" height="64" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-38" value="" style="line;strokeWidth=1;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=3;spacingRight=3;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;strokeColor=inherit;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-36">
          <mxGeometry y="90" width="540" height="8" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-39" value="✅ EXCELLENT DESIGN: Explicit State Machine&#xa;&#xa;+ OnMatchCompleted() ← Main orchestrator&#xa;  1. Check if standing finished&#xa;  2. Check if all groups finished&#xa;  3. If yes: Seed bracket&#xa;  4. Return enriched DTO with lifecycle state&#xa;&#xa;+ SeedBracketIfReady() [Internal]&#xa;  • Idempotent (checks if already seeded)&#xa;  • Prepares teams → Delegates to MatchService.SeedBracket()&#xa;&#xa;Replaces: Old domain event system&#xa;Benefits: Clear flow, testable, debuggable" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=top;spacingLeft=4;spacingRight=4;overflow=hidden;rotatable=0;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=9;" vertex="1" parent="X7BS_atAVVZSwV2Onjna-36">
          <mxGeometry y="98" width="540" height="182" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-40" value="" style="endArrow=block;dashed=1;endFill=0;endSize=12;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-16" target="X7BS_atAVVZSwV2Onjna-3">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="270" y="496" as="sourcePoint" />
            <mxPoint x="430" y="496" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-41" value="" style="endArrow=block;dashed=1;endFill=0;endSize=12;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-20" target="X7BS_atAVVZSwV2Onjna-5">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="710" y="496" as="sourcePoint" />
            <mxPoint x="870" y="496" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-42" value="" style="endArrow=block;dashed=1;endFill=0;endSize=12;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-24" target="X7BS_atAVVZSwV2Onjna-7">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="1200" y="496" as="sourcePoint" />
            <mxPoint x="1360" y="496" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-43" value="" style="endArrow=block;dashed=1;endFill=0;endSize=12;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-28" target="X7BS_atAVVZSwV2Onjna-9">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="1670" y="496" as="sourcePoint" />
            <mxPoint x="1830" y="496" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-44" value="" style="endArrow=block;dashed=1;endFill=0;endSize=12;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-32" target="X7BS_atAVVZSwV2Onjna-11">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="2140" y="496" as="sourcePoint" />
            <mxPoint x="2300" y="496" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-45" value="" style="endArrow=block;dashed=1;endFill=0;endSize=12;html=1;rounded=0;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-36" target="X7BS_atAVVZSwV2Onjna-13">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="2690" y="496" as="sourcePoint" />
            <mxPoint x="2850" y="496" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-46" value="«uses»" style="endArrow=open;endSize=12;dashed=1;html=1;rounded=0;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-16" target="X7BS_atAVVZSwV2Onjna-20">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="470" y="636" as="sourcePoint" />
            <mxPoint x="630" y="636" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-47" value="«uses»" style="endArrow=open;endSize=12;dashed=1;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-16" target="X7BS_atAVVZSwV2Onjna-32">
          <mxGeometry x="-0.3" y="10" width="160" relative="1" as="geometry">
            <mxPoint x="470" y="716" as="sourcePoint" />
            <mxPoint x="1900" y="726" as="targetPoint" />
            <Array as="points">
              <mxPoint x="800" y="656" />
              <mxPoint x="800" y="726" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-48" value="«uses»" style="endArrow=open;endSize=12;dashed=1;html=1;rounded=0;exitX=0;exitY=0.25;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-24" target="X7BS_atAVVZSwV2Onjna-16">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="960" y="586" as="sourcePoint" />
            <mxPoint x="460" y="656" as="targetPoint" />
            <Array as="points">
              <mxPoint x="850" y="596" />
              <mxPoint x="850" y="656" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-49" value="«uses»" style="endArrow=open;endSize=12;dashed=1;html=1;rounded=0;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-24" target="X7BS_atAVVZSwV2Onjna-32">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="1440" y="596" as="sourcePoint" />
            <mxPoint x="1900" y="596" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-50" value="«uses»" style="endArrow=open;endSize=12;dashed=1;html=1;rounded=0;exitX=0;exitY=0.25;exitDx=0;exitDy=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-28" target="X7BS_atAVVZSwV2Onjna-24">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="1480" y="596" as="sourcePoint" />
            <mxPoint x="1440" y="596" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-51" value="«uses»" style="endArrow=open;endSize=12;dashed=1;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-28" target="X7BS_atAVVZSwV2Onjna-36">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="1860" y="666" as="sourcePoint" />
            <mxPoint x="2420" y="666" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-52" value="«uses»" style="endArrow=open;endSize=12;dashed=1;html=1;rounded=0;exitX=0;exitY=0.25;exitDx=0;exitDy=0;entryX=1;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-36" target="X7BS_atAVVZSwV2Onjna-32">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="2420" y="596" as="sourcePoint" />
            <mxPoint x="2380" y="596" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-53" value="«uses»" style="endArrow=open;endSize=12;dashed=1;html=1;rounded=0;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;edgeStyle=orthogonalEdgeStyle;" edge="1" parent="1" source="X7BS_atAVVZSwV2Onjna-36" target="X7BS_atAVVZSwV2Onjna-24">
          <mxGeometry width="160" relative="1" as="geometry">
            <mxPoint x="2420" y="726" as="sourcePoint" />
            <mxPoint x="1440" y="756" as="targetPoint" />
            <Array as="points">
              <mxPoint x="2300" y="726" />
              <mxPoint x="2300" y="756" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-54" value="LEGEND" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;size=20;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="80" y="916" width="600" height="220" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-55" value="✅ GREEN = Good design / No issues&#xa;⚠️ YELLOW = Warning / Needs attention&#xa;🔴 RED = Critical issue&#xa;&#xa;Arrow Types:&#xa;━━━▷ (dashed) = Implements interface&#xa;- - -▷ (open arrow) = Uses / Depends on&#xa;&#xa;Key Observations:&#xa;• All 6 services implement their interfaces&#xa;• TournamentLifecycleService = State machine orchestrator&#xa;• Circular dependencies exist (expected in service layer)&#xa;• Mix of Repository pattern and direct DbContext usage" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="90" y="946" width="580" height="180" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-56" value="⚠️ CRITICAL DESIGN ISSUES" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fillColor=#ffe6e6;strokeColor=#FF0000;align=left;verticalAlign=top;size=20;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="720" y="916" width="700" height="220" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-57" value="1. MatchService.SeedGroups() - TRANSACTION BOUNDARY ISSUE&#xa;   Uses TWO DbContexts: _standingRepository.Save() AND _dbContext.SaveChangesAsync()&#xa;   Risk: Changes committed at different times → data corruption&#xa;&#xa;2. Inconsistent Save Patterns&#xa;   • GenerateMatch() does NOT save (caller must save)&#xa;   • SeedBracket() does NOT save (caller must save)&#xa;   • PrepareTeamsForBracket() modifies entities but doesn&#39;t save&#xa;   Risk: Easy to forget to save, unclear transaction ownership&#xa;&#xa;3. Misleading Method Name&#xa;   CheckAndMarkAllGroupsAreFinishedAsync() only checks, doesn&#39;t mark&#xa;   Fix: Rename to AreAllGroupsFinishedAsync()&#xa;&#xa;4. Repository + DbContext Anti-Pattern&#xa;   All services inject BOTH IGenericRepository&lt;T&gt; AND ITO2DbContext&#xa;   Fix: Pick one pattern consistently" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="730" y="946" width="680" height="180" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-58" value="✅ POSITIVE DESIGN PATTERNS" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fillColor=#e6ffe6;strokeColor=#00CC00;align=left;verticalAlign=top;size=20;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1460" y="916" width="740" height="220" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-59" value="1. TournamentLifecycleService - EXCELLENT STATE MACHINE&#xa;   • Replaces implicit domain events with explicit orchestration&#xa;   • OnMatchCompleted() = single entry point for lifecycle transitions&#xa;   • Clear, testable, debuggable flow&#xa;&#xa;2. Comprehensive Validation in TeamService.AddTeamToTournamentAsync()&#xa;   • Checks registration open, capacity, duplicate names&#xa;   • Business rules enforced at service layer&#xa;&#xa;3. No Unused Methods - All 38 methods are actively used&#xa;   • Controllers use public APIs&#xa;   • Services call each other for orchestration&#xa;&#xa;4. Interface Segregation - Each service has focused responsibility&#xa;   • Tournament CRUD, Team CRUD, Match generation, Game scoring, etc.&#xa;&#xa;5. Extensive Logging Throughout" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="1470" y="946" width="720" height="180" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-60" value="📊 SERVICE METRICS" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;fillColor=#fff9e6;strokeColor=#FF8000;align=left;verticalAlign=top;size=20;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="2240" y="916" width="720" height="220" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-61" value="Total Services: 6&#xa;Total Methods: 38&#xa;Unused Methods: 0 ✅&#xa;&#xa;Most Connected Service: StandingService&#xa;• GetStandingsAsync() called by 8 different places&#xa;&#xa;Least Connected: TeamService&#xa;• Only called by TournamentService.RemoveTeamFromTournamentAsync()&#xa;&#xa;Heaviest Service: MatchService&#xa;• 8 dependencies injected&#xa;• Most complex algorithms (SeedGroups, SeedBracket)&#xa;&#xa;Critical Path:&#xa;SetGameResult → DetermineMatchWinner → UpdateStandingAfterMatch →&#xa;OnMatchCompleted → SeedBracketIfReady" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="2250" y="946" width="700" height="180" as="geometry" />
        </mxCell>
        <mxCell id="X7BS_atAVVZSwV2Onjna-62" value="Note: All services use Repository pattern with explicit Save() calls + direct DbContext for complex queries" style="text;html=1;strokeColor=#d6b656;fillColor=#fff2cc;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="80" y="836" width="880" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
